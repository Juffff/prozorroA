{"version":3,"sources":["../../../../build/server/utils/tendersComparator.js"],"names":["Object","defineProperty","exports","value","default","oldTender","newTender","tenderDifferences","compareNames","names","compareStartDates","startDates","toString","comparePublishedDates","PublishedDates","compareIds","iDs","compareTitles","titles","compareAmounts","amounts","compareCurrencies","currencies","compareStatuses","statuses","compareTenderers","assign","tenderers","compareSuppliers","suppliers","compareItems","items","compareClassification_ids","classification_ids","formatDate","date","Date","toLocaleDateString","name","startDate","datePublished","tenderID","title","Number","parseInt","amount","currency","status","compareArrays","oldArray","newArray","tOldArray","tNewArray","added","deleted","forEach","el","indexOf","push","length","compareArraysDesc","fName","description","compareResult","join"],"mappings":"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","file":"tendersComparator.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (oldTender, newTender) {\n\n    /*const newTender = {\n        \"_id\": \"a188a975c4984bd68c67e61ef187c54e\",\n        \"history\": {\n            \"2018-5-21\": \"Added to DB\"\n        },\n        \"status\": \"Закупка не состоялась\",\n        \"currency\": \"UAH\",\n        \"amount\": \"7500000\",\n        \"title\": \"“Послуги з технічної підтримки програмного забезпечення Oracle Database”.\",\n        \"tenderID\": \"UA-2017-10-13-001799-a\",\n        \"awardCriteria\": \"lowestCost\",\n        \"startDate\": \"2017-11-23T12:38:39+02:00\",\n        \"datePublished\": \"2017-10-13T14:06:56.116592+03:00\",\n        \"name\": \"Національний Банк України\",\n        \"classification_ids\": [\n            \"72260000-5\"\n        ],\n        \"items\": [\n            \"Послуги, пов’язані з програмним забезпеченням\"\n        ],\n        \"tenderers\": [\n            \"ТОВ \\\"ОС КОНСАЛТІНГ\\\"\",\n            \"ТОВ \\\"РДТЕХ\\\"\",\n            \"Приватне Акціонерне Товариство \\\"Пріоком\\\"\",\n            \"ТОВ \\\"ЦЕНТР СИСТЕМНОЇ ІНТЕГРАЦІЇ\\\"\",\n            \"ТОВ \\\"DILDO\\\"\"\n        ],\n        \"__v\": 0\n    };*/\n\n    var tenderDifferences = {};\n    if (compareNames(oldTender, newTender) !== 0) {\n        tenderDifferences.names = compareNames(oldTender, newTender);\n    }\n\n    if (compareStartDates(oldTender, newTender) !== 0) {\n        tenderDifferences.startDates = compareStartDates(oldTender, newTender).toString();\n    }\n\n    if (comparePublishedDates(oldTender, newTender) !== 0) {\n        tenderDifferences.PublishedDates = comparePublishedDates(oldTender, newTender);\n    }\n\n    if (compareIds(oldTender, newTender) !== 0) {\n        tenderDifferences.iDs = compareIds(oldTender, newTender);\n    }\n\n    if (compareTitles(oldTender, newTender) !== 0) {\n        tenderDifferences.titles = compareTitles(oldTender, newTender);\n    }\n\n    if (compareAmounts(oldTender, newTender) !== 0) {\n        tenderDifferences.amounts = compareAmounts(oldTender, newTender);\n    }\n\n    if (compareCurrencies(oldTender, newTender) !== 0) {\n        tenderDifferences.currencies = compareCurrencies(oldTender, newTender);\n    }\n\n    if (compareStatuses(oldTender, newTender) !== 0) {\n        tenderDifferences.statuses = compareStatuses(oldTender, newTender);\n    }\n\n    if (compareTenderers(oldTender, newTender) !== 0) {\n        tenderDifferences = Object.assign({}, tenderDifferences, { tenderers: compareTenderers(oldTender, newTender) });\n    }\n\n    if (compareSuppliers(oldTender, newTender) !== 0) {\n        tenderDifferences.suppliers = compareSuppliers(oldTender, newTender);\n    }\n\n    if (compareItems(oldTender, newTender) !== 0) {\n        tenderDifferences.items = compareItems(oldTender, newTender);\n    }\n\n    if (compareClassification_ids(oldTender, newTender) !== 0) {\n        tenderDifferences.classification_ids = compareClassification_ids(oldTender, newTender);\n    }\n\n    return tenderDifferences;\n};\n\nfunction formatDate(date) {\n    return new Date(date).toLocaleDateString();\n}\n\nfunction compareNames(oldTender, newTender) {\n    if (oldTender.name === newTender.name) {\n        return 0;\n    } else {\n        return '\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u043E \\u0438\\u043C\\u044F: ' + oldTender.name + ' -> ' + newTender.name;\n    }\n}\n\nfunction compareStartDates(oldTender, newTender) {\n    if (oldTender.startDate === newTender.startDate) {\n        return 0;\n    } else return '\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0430 \\u0434\\u0430\\u0442\\u0430 \\u0430\\u0443\\u043A\\u0446\\u0438\\u043E\\u043D\\u0430: ' + formatDate(oldTender.startDate) + ' -> ' + formatDate(newTender.startDate);\n}\n\nfunction comparePublishedDates(oldTender, newTender) {\n    if (oldTender.datePublished === newTender.datePublished) {\n        return 0;\n    } else return '\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0430 \\u0434\\u0430\\u0442\\u0430 \\u043F\\u0443\\u0431\\u043B\\u0438\\u043A\\u0430\\u0446\\u0438\\u0438: ' + formatDate(oldTender.datePublished) + ' -> ' + formatDate(newTender.datePublished);\n}\n\nfunction compareIds(oldTender, newTender) {\n    if (oldTender.tenderID === newTender.tenderID) {\n        return 0;\n    } else return '\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D \\u0438\\u0434\\u0435\\u043D\\u0442\\u0438\\u0444\\u0438\\u043A\\u0430\\u0442\\u043E\\u0440: ' + oldTender.tenderID + ' -> ' + newTender.tenderID;\n}\n\nfunction compareTitles(oldTender, newTender) {\n    if (oldTender.title === newTender.title) {\n        return 0;\n    } else return '\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u043E \\u043E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435: ' + oldTender.title + ' -> ' + newTender.title;\n}\n\nfunction compareAmounts(oldTender, newTender) {\n    if (Number.parseInt(oldTender.amount) === Number.parseInt(newTender.amount)) {\n        return 0;\n    } else return '\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D \\u0431\\u044E\\u0434\\u0436\\u0435\\u0442: ' + oldTender.amount + ' -> ' + newTender.amount;\n}\n\nfunction compareCurrencies(oldTender, newTender) {\n    if (oldTender.currency === newTender.currency) {\n        return 0;\n    } else return '\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0430 \\u0432\\u0430\\u043B\\u044E\\u0442\\u0430: ' + oldTender.currency + ' -> ' + newTender.currency;\n}\n\nfunction compareStatuses(oldTender, newTender) {\n    if (oldTender.status === newTender.status) {\n        return 0;\n    } else return '\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441: ' + oldTender.status + ' -> ' + newTender.status;\n}\n\nfunction compareArrays(oldArray, newArray) {\n    var tOldArray = [];\n    var tNewArray = [];\n    if (oldArray) {\n        tOldArray = oldArray;\n    } else {\n        tOldArray = [];\n    }\n\n    if (newArray) {\n        tNewArray = newArray;\n    } else {\n        tNewArray = [];\n    }\n\n    var added = [];\n    var deleted = [];\n    tNewArray.forEach(function (el) {\n        if (tOldArray.indexOf(el) === -1) {\n            added.push(el);\n        }\n    });\n\n    tOldArray.forEach(function (el) {\n        if (tNewArray.indexOf(el) === -1) {\n            deleted.push(el);\n        }\n    });\n\n    if (added.length === 0 && deleted.length === 0) {\n        return 0;\n    } else {\n        if (added.length === 0 && deleted.length !== 0) {\n            return { deleted: deleted };\n        }\n        if (added.length !== 0 && deleted.length === 0) {\n            return { added: added };\n        }\n        if (added.length !== 0 && deleted.length !== 0) {\n            return { added: added, deleted: deleted };\n        }\n    }\n}\n\nfunction compareArraysDesc(oldTender, newTender, fName, description) {\n    var compareResult = compareArrays(oldTender[fName], newTender[fName]);\n    if (compareResult === 0) {\n        return 0;\n    } else {\n        var added = '';\n        var deleted = '';\n        if (compareResult.added) {\n            added = '\\u0414\\u043E\\u0431\\u0430\\u0432\\u043B\\u0435\\u043D\\u044B ' + description + ':  + ' + compareResult.added.join(', ');\n        }\n        if (compareResult.deleted) {\n            deleted = '\\u0423\\u0434\\u0430\\u043B\\u0435\\u043D\\u044B ' + description + ':  + ' + compareResult.deleted.join(', ');\n        }\n\n        if (added.length > 0 && deleted.length > 0) {\n            return added + '; ' + deleted;\n        }\n\n        if (added.length > 0 && deleted.length === 0) {\n            return added;\n        }\n\n        if (added.length === 0 && deleted.length > 0) {\n            return deleted;\n        }\n    }\n}\n\nfunction compareTenderers(oldTender, newTender) {\n    return compareArraysDesc(oldTender, newTender, 'tenderers', 'участники');\n}\n\nfunction compareSuppliers(oldTender, newTender) {\n    return compareArraysDesc(oldTender, newTender, 'suppliers', 'победители');\n}\n\nfunction compareItems(oldTender, newTender) {\n    return compareArraysDesc(oldTender, newTender, 'items', 'товары');\n}\n\nfunction compareClassification_ids(oldTender, newTender) {\n    return compareArraysDesc(oldTender, newTender, 'classification_ids', 'классификаторы');\n}"]}