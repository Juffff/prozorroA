{"version":3,"sources":["../../client/script.js"],"names":["window","onload","searchButton","document","getElementById","searchInput","clearSearchInput","$","click","e","attr","Date","toLocaleDateString","toLocaleTimeString","encodeURIComponent","html","addEventListener","event","preventDefault","keyCode","onclick","innerHTML","listReq","value","sortByDatePublished","search","sort","server","fetch","then","response","json","tBody","forEach","Object","values","el","join","toLowerCase","indexOf","createTr","catch","console","log","data","dataToBeSorted","map","datePublished","undefined","a","b","data1","data2","createTd","className","link","cssText","createElement","classList","add","openInNewTab","style","ondblclick","createUlTD","Array","isArray","td","ul","li","appendChild","setColorOfTr","status","tr","tenderID","name","Number","parseInt","amount","toString","replace","title","startDate","tenderers","suppliers","currency","items","classification_ids","statueEnum","url","win","open","focus"],"mappings":"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","file":"script.js","sourcesContent":["window.onload = () => {\n\n    const searchButton = document.getElementById('searchButton');\n    const searchInput = document.getElementById('searchInput');\n    const clearSearchInput = document.getElementById('clearSearchButton');\n\n    $(\"#btnExport\").click(function (e) {\n        $(this).attr({\n            'download': `ProzorroAnalytics_${new Date().toLocaleDateString()}_${new Date().toLocaleTimeString()}.xls`,\n            'href': 'data:application/csv;charset=utf-8,' + encodeURIComponent($('#dvData').html())\n        })\n    });\n\n    searchInput.addEventListener(\"keyup\", function (event) {\n        event.preventDefault();\n        if (event.keyCode === 13) {\n            searchButton.click();\n        }\n    });\n\n    searchButton.onclick = function () {\n        document.getElementById('tBody').innerHTML = '';\n        listReq(searchInput.value, sortByDatePublished);\n    };\n\n    clearSearchInput.onclick = function () {\n        searchInput.value = '';\n        document.getElementById('tBody').innerHTML = '';\n        listReq('');\n    };\n\n    function listReq(search, sort) {\n        const server = 'http://localhost:8080/';\n        fetch(server)\n            .then(response => response.json())\n            .then(json => {\n                if (typeof sort === 'function') {\n                    return sort(json);\n                } else return sortByDatePublished(json);\n            })\n            .then(json => {\n                    const tBody = document.getElementById('tBody');\n                    json.forEach(el => {\n                        if (Object.values(el).join('').toLowerCase().indexOf(search.toLowerCase()) !== -1) {\n                            createTr(el, tBody);\n                        }\n                    });\n                }\n            )\n            .catch(console.log);\n    }\n\n    function sortByDatePublished(data) {\n        const dataToBeSorted = data.map(el => {\n            if (el.datePublished === undefined) {\n                el.datePublished = null;\n                return el;\n            } else return el;\n        });\n        return dataToBeSorted.sort((a, b) => {\n            let data1 = new Date(a.datePublished);\n            let data2 = new Date(b.datePublished);\n            if (data1 < data2) {\n                return 1;\n            }\n            if (data1 > data2) {\n                return -1;\n            }\n            return 0;\n        });\n    }\n\n    const createTd = (data, className, link, cssText) => {\n        const el = document.createElement('td');\n        if (className) {\n            el.classList.add(className);\n        }\n        if (link) {\n            el.addEventListener('click', () => openInNewTab(link));\n        }\n        if (cssText) {\n            el.style.cssText = cssText;\n        }\n        if (!data) el.innerHTML = ''; else el.innerHTML = data;\n        el.ondblclick = function () {\n            searchInput.value = el.innerHTML;\n            document.getElementById('tBody').innerHTML = '';\n            listReq(searchInput.value);\n        };\n        return el;\n    };\n\n    const createUlTD = (data, cssText) => {\n        if (Array.isArray(data)) {\n            const td = document.createElement('td');\n            td.style.cssText = cssText;\n            const ul = document.createElement('ul');\n            data.forEach(el => {\n                const li = document.createElement('li');\n                li.innerHTML = el;\n                li.ondblclick = function () {\n                    searchInput.value = li.innerHTML;\n                    document.getElementById('tBody').innerHTML = '';\n                    listReq(searchInput.value);\n                };\n                ul.appendChild(li);\n            });\n            td.appendChild(ul);\n            return td;\n        } else return createTd(data, false, false, `background-color: ${setColorOfTr(data.status)}`);\n\n    };\n\n    const createTr = (data, tBody) => {\n        const tr = document.createElement('tr');\n        let className = 'default';\n        tr.classList.add(className);\n        tr.appendChild(createTd(data.tenderID, 'href', `https://prozorro.gov.ua/tender/${data.tenderID}`, `background-color: ${setColorOfTr(data.status)}`));\n        tr.appendChild(createTd(data.name, false, false, `background-color: ${setColorOfTr(data.status)}`));\n        tr.appendChild(createTd(Number.parseInt(data.amount, 0).toString().replace(/(\\d{1,3})(?=((\\d{3})*([^\\d]|$)))/g, \" $1 \").replace('.', ',').replace(' ,', ',').replace(', ', ','), false, false, `text-align: end; background-color: ${setColorOfTr(data.status)}`));\n        tr.appendChild(createTd(data.title, false, false, `background-color: ${setColorOfTr(data.status)}`));\n        tr.appendChild(createTd(data.status, false, false, `background-color: ${setColorOfTr(data.status)}`));\n        if (data.datePublished) {\n            tr.appendChild(createTd(new Date(data.datePublished).toLocaleDateString(), false, false, `text-align: center; background-color: ${setColorOfTr(data.status)}`));\n        } else {\n            tr.appendChild(createTd('', false, false, `background-color: ${setColorOfTr(data.status)}`));\n        }\n        if (data.startDate) {\n            tr.appendChild(createTd(new Date(data.startDate).toLocaleDateString(), false, false, `background-color: ${setColorOfTr(data.status)}`));\n        } else {\n            tr.appendChild(createTd('', false, false, `background-color: ${setColorOfTr(data.status)}`));\n        }\n        tr.appendChild(createUlTD(data.tenderers, `background-color: ${setColorOfTr(data.status)}`));\n        tr.appendChild(createUlTD(data.suppliers, `background-color: ${setColorOfTr(data.status)}`));\n        tr.appendChild(createTd(data.currency, false, false, `text-align: center; background-color: ${setColorOfTr(data.status)}`));\n        tr.appendChild(createUlTD(data.items, `background-color: ${setColorOfTr(data.status)}`));\n        tr.appendChild(createUlTD(data.classification_ids, `background-color: ${setColorOfTr(data.status)}`));\n        tBody.appendChild(tr);\n    };\n\n};\n\nfunction setColorOfTr(status) {\n    let statueEnum = {\n        'Переговоры': 'lightgreen',\n        'Период уточнений': 'lightgreen',\n        'Ожидание предложений': 'lightgreen',\n        'Период аукциона': 'lightcyan',\n        'Квалификация победителя': 'lightcyan',\n        'Квалификация/Переквалификация': 'lightcyan',\n        'Преквалификация/Период оспариваний': 'lightcyan',\n        'Предложения рассмотрены': 'greenyellow',\n        'Закупка не состоялась': 'lightpink',\n        'Закупка закончена': 'lightgrey',\n        'Закупка отменена': 'lightpink'\n    };\n    return statueEnum[status];\n}\n\nfunction openInNewTab(url) {\n    const win = window.open(url, '_blank');\n    win.focus();\n}"]}