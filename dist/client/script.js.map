{"version":3,"sources":["../../client/script.js"],"names":["window","onload","searchButton","document","getElementById","searchInput","clearSearchInput","exportToExcelButton","onclick","$","tableExport","addEventListener","event","preventDefault","keyCode","click","innerHTML","listReq","value","sortByDatePublished","search","sort","server","fetch","then","response","json","tBody","forEach","Object","values","el","join","toLowerCase","indexOf","createTr","catch","console","log","data","dataToBeSorted","map","datePublished","undefined","a","b","data1","Date","data2","createTd","className","link","cssText","createElement","classList","add","openInNewTab","style","ondblclick","createUlTD","Array","isArray","td","ul","li","appendChild","tr","setColorOfTr","status","tenderID","name","Number","parseInt","amount","toString","replace","title","toLocaleDateString","startDate","tenderers","suppliers","currency","items","classification_ids","statueEnum","url","win","open","focus"],"mappings":"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","file":"script.js","sourcesContent":["window.onload = () => {\n\n    const searchButton = document.getElementById('searchButton');\n    const searchInput = document.getElementById('searchInput');\n    const clearSearchInput = document.getElementById('clearSearchButton');\n    const exportToExcelButton = document.getElementById('exportToExcelButton');\n\n    exportToExcelButton.onclick = function () {\n        $(\"table\").tableExport();\n    };\n\n    searchInput.addEventListener(\"keyup\", function (event) {\n        event.preventDefault();\n        if (event.keyCode === 13) {\n            searchButton.click();\n        }\n    });\n\n    searchButton.onclick = function () {\n        document.getElementById('tBody').innerHTML = '';\n        listReq(searchInput.value, sortByDatePublished);\n    };\n\n    clearSearchInput.onclick = function () {\n        searchInput.value = '';\n        document.getElementById('tBody').innerHTML = '';\n        listReq('');\n    };\n\n    function listReq(search, sort) {\n        const server = 'http://localhost:8080/';\n        fetch(server)\n            .then(response => response.json())\n            .then(json => {\n                if(typeof sort === 'function'){\n                    return sort(json);\n                } else  return sortByDatePublished(json);\n            })\n            .then(json => {\n                    const tBody = document.getElementById('tBody');\n                    json.forEach(el => {\n                        if (Object.values(el).join('').toLowerCase().indexOf(search.toLowerCase()) !== -1) {\n                            createTr(el, tBody);\n                        }\n                    });\n                }\n            )\n            .catch(console.log);\n    }\n\n    function sortByDatePublished(data) {\n        const dataToBeSorted = data.map(el => {\n            if (el.datePublished === undefined) {\n                el.datePublished = null;\n                return el;\n            } else return el;\n        });\n        return dataToBeSorted.sort((a, b) => {\n            let data1 = new Date(a.datePublished);\n            let data2 = new Date(b.datePublished);\n            if (data1 < data2) {\n                return 1;\n            }\n            if (data1 > data2) {\n                return -1;\n            }\n            return 0;\n        });\n    }\n\n    const createTd = (data, className, link, cssText) => {\n        const el = document.createElement('td');\n        if (className) {\n            el.classList.add(className);\n        }\n        if (link) {\n            el.addEventListener('click', () => openInNewTab(link));\n        }\n        if(cssText){\n            el.style.cssText = cssText;\n        }\n        if (!data) el.innerHTML = ''; else el.innerHTML = data;\n        el.ondblclick = function () {\n            searchInput.value = el.innerHTML;\n            document.getElementById('tBody').innerHTML = '';\n            listReq(searchInput.value);\n        };\n        return el;\n    };\n\n    const createUlTD = (data) => {\n        if (Array.isArray(data)) {\n            const td = document.createElement('td');\n            const ul = document.createElement('ul');\n            data.forEach(el => {\n                const li = document.createElement('li');\n                li.innerHTML = el;\n                li.ondblclick = function () {\n                    searchInput.value = li.innerHTML;\n                    document.getElementById('tBody').innerHTML = '';\n                    listReq(searchInput.value);\n                };\n                ul.appendChild(li);\n            });\n            td.appendChild(ul);\n            return td;\n        } else return createTd(data);\n\n    };\n\n    const createTr = (data, tBody) => {\n        const tr = document.createElement('tr');\n        tr.style.cssText = `background-color: ${setColorOfTr(data.status)}`;\n        let className = 'default';\n        tr.classList.add(className);\n        tr.appendChild(createTd(data.tenderID, 'href', `https://prozorro.gov.ua/tender/${data.tenderID}`));\n        tr.appendChild(createTd(data.name));\n        tr.appendChild(createTd(Number.parseInt(data.amount, 0).toString().replace(/(\\d{1,3})(?=((\\d{3})*([^\\d]|$)))/g, \" $1 \").replace('.', ',').replace(' ,', ',').replace(', ', ','),false,false,'text-align: end;'));\n        tr.appendChild(createTd(data.title));\n        tr.appendChild(createTd(data.status));\n        if (data.datePublished) {\n            tr.appendChild(createTd(new Date(data.datePublished).toLocaleDateString(),false,false,'text-align: center'));\n        } else {\n            tr.appendChild(createTd(''));\n        }\n        if (data.startDate) {\n            tr.appendChild(createTd(new Date(data.startDate).toLocaleDateString()));\n        } else {\n            tr.appendChild(createTd(''));\n        }\n        tr.appendChild(createUlTD(data.tenderers));\n        tr.appendChild(createUlTD(data.suppliers));\n        tr.appendChild(createTd(data.currency,false,false,'text-align: center;'));\n        tr.appendChild(createUlTD(data.items));\n        tr.appendChild(createUlTD(data.classification_ids));\n        tBody.appendChild(tr);\n    };\n\n};\n\nfunction setColorOfTr(status) {\n    let statueEnum = {\n        'Переговоры': 'lightgreen',\n        'Период уточнений': 'lightgreen',\n        'Ожидание предложений': 'lightgreen',\n        'Период аукциона': 'lightcyan',\n        'Квалификация победителя': 'lightcyan',\n        'Квалификация/Переквалификация': 'lightcyan',\n        'Преквалификация/Период оспариваний': 'lightcyan',\n        'Предложения рассмотрены': 'greenyellow',\n        'Закупка не произошла': 'lightpink',\n        'Закупка закончена': 'lightgrey',\n        'Закупка отменена': 'lightpink'\n    };\n    return statueEnum[status];\n}\n\nfunction openInNewTab(url) {\n    const win = window.open(url, '_blank');\n    win.focus();\n}"]}