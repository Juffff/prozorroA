{"version":3,"sources":["../../../server/utils/tendersComparator.js"],"names":["oldTender","newTender2","newTender","tenderDifferences","compareNames","names","compareStartDates","startDates","toString","comparePublishedDates","PublishedDates","compareIds","iDs","compareTitles","titles","compareAmounts","amounts","compareCurrencies","currencies","compareStatuses","statuses","Object","assign","tenderers","compareTenderers","console","log","formatDate","date","Date","toLocaleTimeString","name","startDate","datePublished","tenderID","title","Number","parseInt","amount","currency","status","compareArrays","oldArray","newArray","added","deleted","forEach","indexOf","el","push","length","compareArraysDesc","fName","description","compareResult","join","compareSuppliers","compareItems","compareClassification_ids"],"mappings":"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","file":"tendersComparator.js","sourcesContent":["function formatDate(date) {\n    return new Date(date).toLocaleTimeString();\n}\n\nfunction compareNames(oldTender, newTender) {\n    if (oldTender.name === newTender.name) {\n        return 0;\n    } else {\n        return `Изменено имя: ${oldTender.name} -> ${newTender.name}`\n    }\n}\n\n\nfunction compareStartDates(oldTender, newTender) {\n    if (oldTender.startDate === newTender.startDate) {\n        return 0;\n    } else return `Изменена дата аукциона: ${formatDate(oldTender.startDate)} -> ${formatDate(newTender.startDate)}`;\n}\n\nfunction comparePublishedDates(oldTender, newTender) {\n    if (oldTender.datePublished === newTender.datePublished) {\n        return 0;\n    } else return `Изменена дата публикации: ${formatDate(oldTender.datePublished)} -> ${formatDate(newTender.datePublished)}`;\n}\n\nfunction compareIds(oldTender, newTender) {\n    if (oldTender.tenderID === newTender.tenderID) {\n        return 0;\n    } else return `Изменен идентификатор: ${oldTender.tenderID} -> ${newTender.tenderID}`\n}\n\nfunction compareTitles(oldTender, newTender) {\n    if (oldTender.title === newTender.title) {\n        return 0;\n    } else return `Изменено описание: ${oldTender.title} -> ${newTender.title}`\n}\n\nfunction compareAmounts(oldTender, newTender) {\n    if (Number.parseInt(oldTender.amount) === Number.parseInt(newTender.amount)) {\n        return 0;\n    } else return `Изменен бюджет: ${oldTender.amount} -> ${newTender.amount}`\n}\n\nfunction compareCurrencies(oldTender, newTender) {\n    if (oldTender.currency === newTender.currency) {\n        return 0;\n    } else return `Изменена валюта: ${oldTender.currency} -> ${newTender.currency}`\n}\n\nfunction compareStatuses(oldTender, newTender) {\n    if (oldTender.status === newTender.status) {\n        return 0;\n    } else return `Изменен статус: ${oldTender.status} -> ${newTender.status}`\n}\n\nfunction compareArrays(oldArray, newArray) {\n    let added = [];\n    let deleted = [];\n    newArray.forEach(el => {\n        if (oldArray.indexOf(el) === -1) {\n            added.push(el);\n        }\n    });\n\n    oldArray.forEach(el => {\n        if (newArray.indexOf(el) === -1) {\n            deleted.push(el);\n        }\n    });\n\n    if (added.length === 0 && deleted.length === 0) {\n        return 0;\n    } else {\n        if (added.length === 0 && deleted.length !== 0) {\n            return {deleted: deleted}\n        }\n        if (added.length !== 0 && deleted.length === 0) {\n            return {added: added}\n        }\n        if (added.length !== 0 && deleted.length !== 0) {\n            return {added: added, deleted: deleted}\n        }\n    }\n}\n\nfunction compareArraysDesc(oldTender, newTender, fName, description) {\n    const compareResult = compareArrays(oldTender[fName], newTender[fName]);\n    console.log(compareResult);\n    if (compareResult === 0) {\n        return 0;\n    } else {\n        let added = '';\n        let deleted = '';\n        if (compareResult.added) {\n            added = `Добавлены ${description}:  + ${compareResult.added.join(', ')}`;\n        }\n        if (compareResult.added) {\n            deleted = `Удалены ${description}:  + ${compareResult.deleted.join(', ')}`;\n        }\n        return added + ';' + deleted;\n    }\n}\n\nfunction compareTenderers(oldTender, newTender) {\n    //console.log(compareArraysDesc(oldTender, newTender, 'tenderers', 'участники'));\n    return compareArraysDesc(oldTender, newTender, 'tenderers', 'участники');\n}\n\nfunction compareSuppliers(oldTender, newTender) {\n    return compareArraysDesc(oldTender, newTender, 'suppliers', 'победители');\n}\n\nfunction compareItems(oldTender, newTender) {\n    return compareArraysDesc(oldTender, newTender, 'items', 'товары');\n}\n\nfunction compareClassification_ids(oldTender, newTender) {\n    return compareArraysDesc(oldTender, newTender, 'classification_ids', 'классификаторы');\n}\n\nexport default function (oldTender, newTender2) {\n\n    const newTender = {\n        \"_id\": \"a188a975c4984bd68c67e61ef187c54e\",\n        \"history\": {\n            \"2018-5-21\": \"Added to DB\"\n        },\n        \"status\": \"Закупка не состоялась\",\n        \"currency\": \"UAH\",\n        \"amount\": \"7500000\",\n        \"title\": \"“Послуги з технічної підтримки програмного забезпечення Oracle Database”.\",\n        \"tenderID\": \"UA-2017-10-13-001799-a\",\n        \"awardCriteria\": \"lowestCost\",\n        \"startDate\": \"2017-11-23T12:38:39+02:00\",\n        \"datePublished\": \"2017-10-13T14:06:56.116592+03:00\",\n        \"name\": \"Національний Банк України\",\n        \"classification_ids\": [\n            \"72260000-5\"\n        ],\n        \"items\": [\n            \"Послуги, пов’язані з програмним забезпеченням\"\n        ],\n        \"tenderers\": [\n            \"ТОВ \\\"ОС КОНСАЛТІНГ\\\"\",\n            \"ТОВ \\\"РДТЕХ\\\"\",\n            \"Приватне Акціонерне Товариство \\\"Пріоком\\\"\",\n            \"ТОВ \\\"ЦЕНТР СИСТЕМНОЇ ІНТЕГРАЦІЇ\\\"\",\n            \"ТОВ \\\"DILDO\\\"\"\n        ],\n        \"__v\": 0\n    };\n\n    let tenderDifferences = {};\n    if (compareNames(oldTender, newTender) !== 0) {\n        tenderDifferences.names = compareNames(oldTender, newTender);\n    }\n    //console.log(compareNames(oldTender, newTender), compareNames(oldTender, newTender) !== 0);\n\n    if (compareStartDates(oldTender, newTender) !== 0) {\n        tenderDifferences.startDates = compareStartDates(oldTender, newTender).toString();\n    }\n   // console.log(compareStartDates(oldTender, newTender), compareStartDates(oldTender, newTender) !== 0);\n\n    if (comparePublishedDates(oldTender, newTender) !== 0) {\n        tenderDifferences.PublishedDates = comparePublishedDates(oldTender, newTender)\n    }\n   // console.log(comparePublishedDates(oldTender, newTender), comparePublishedDates(oldTender, newTender) !== 0);\n\n    if (compareIds(oldTender, newTender) !== 0) {\n        tenderDifferences.iDs = compareIds(oldTender, newTender)\n    }\n   // console.log(compareIds(oldTender, newTender), compareIds(oldTender, newTender) !== 0);\n\n    if (compareTitles(oldTender, newTender) !== 0) {\n        tenderDifferences.titles = compareTitles(oldTender, newTender);\n    }\n    //console.log(compareTitles(oldTender, newTender), compareTitles(oldTender, newTender) !== 0);\n\n    if (compareAmounts(oldTender, newTender) !== 0) {\n        tenderDifferences.amounts = compareAmounts(oldTender, newTender);\n    }\n   // console.log(compareAmounts(oldTender, newTender), compareAmounts(oldTender, newTender) !== 0);\n\n    if (compareCurrencies(oldTender, newTender) !== 0) {\n        tenderDifferences.currencies = compareCurrencies(oldTender, newTender);\n    }\n\n    //console.log(compareCurrencies(oldTender, newTender), compareCurrencies(oldTender, newTender) !== 0);\n\n    if (compareStatuses(oldTender, newTender) !== 0) {\n        tenderDifferences.statuses = compareStatuses(oldTender, newTender)\n    }\n   // console.log(compareStatuses(oldTender, newTender), compareStatuses(oldTender, newTender) !== 0);\n\n    if ((oldTender, newTender) !== 0) {\n        tenderDifferences = Object.assign({}, tenderDifferences, {tenderers: compareTenderers(oldTender, newTender)})\n    }\n  //  console.log(compareTenderers(oldTender, newTender), compareTenderers(oldTender, newTender) !== 0);\n\n    /*if (compareSuppliers(oldTender, newTender) !== 0) {\n        tenderDifferences.suppliers = compareSuppliers(oldTender, newTender)\n    }\n    console.log(compareSuppliers(oldTender, newTender), compareSuppliers(oldTender, newTender) !== 0);\n\n\n    if (compareItems(oldTender, newTender) !== 0) {\n        tenderDifferences.items = compareItems(oldTender, newTender)\n    }\n    console.log(compareItems(oldTender, newTender), compareItems(oldTender, newTender) !== 0);\n\n    if (compareClassification_ids(oldTender, newTender) !== 0) {\n        tenderDifferences.classification_ids = compareClassification_ids(oldTender, newTender)\n    }\n    console.log(compareClassification_ids(oldTender, newTender), compareClassification_ids(oldTender, newTender) !== 0);*/\n\n    console.log(tenderDifferences);\n    return tenderDifferences;\n}\n"]}